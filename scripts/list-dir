#!/usr/bin/env execution-env-resolver python,python3

import os
import argparse
from termcolor import colored


parser = argparse.ArgumentParser()

parser.add_argument("-f", "--fullpath",
                    help="Prints full paths to files or dirs listed", action="store_true")
parser.add_argument("-a", "--all-files",
                    help="Prints hidden files as well", action="store_true")

args = parser.parse_args()


class Colors:
    DIR_COLOR = 'magenta'
    FILE_COLOR = 'cyan'
    TYPE_COLOR = 'yellow'


def sort_by_type_and_name(item_name):
    path = os.path.join(os.getcwd(), item_name)
    isdir = os.path.isdir(path)
    return f'{"dir" if isdir else "file"}_{item_name}'


filtered_dir_items = [item for item in os.listdir(
) if not item.startswith(".") or args.all_files is True]

sorted = sorted(filtered_dir_items, key=sort_by_type_and_name)


def add_space(num):
    return "".join([" " for n in range(num)])


for i in sorted:
    path = os.path.join(os.getcwd(), i)
    if os.path.isdir(path):
        is_dir = True
        if args.fullpath:
            message = colored(f'{path}/', Colors.DIR_COLOR)
        else:
            message = colored(f'{i}/', Colors.DIR_COLOR)
        
        type_message = colored('DIR', Colors.TYPE_COLOR)
        print(f'[{type_message}]{add_space(5)}{message}')
    else:
        if args.fullpath:
            message = colored(f'{path}', Colors.FILE_COLOR)
        else:
            message = colored(f'{i}', Colors.FILE_COLOR)

        type_message = colored('FILE', Colors.TYPE_COLOR)
        print(f'[{type_message}]{add_space(4)}{message}')
